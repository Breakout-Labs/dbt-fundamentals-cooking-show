version: 2

models:
  - name: orders_by_category_monthly
    description: >
      Monthly aggregated sales metrics by product category.
    columns:
      - name: product_subcategory_month_id
        description: Surrogate key
        data_tests:
          - not_null
          - unique
          
      - name: order_month
        description: The month for which metrics are aggregated in YYYY-MM format.
        data_tests:
          - not_null

      - name: product_category
        description: The main product category.
        data_tests:
          - not_null

      - name: product_subcategory
        description: The product subcategory.

      - name: order_count
        description: Total number of distinct orders containing products from this category in the month.
        data_tests:
          - not_null

      - name: total_quantity_sold
        description: Total quantity of products sold in this category during the month.
        data_tests:
          - not_null
          - greater_than_or_equal_to:
              arguments:
                value: 0

      - name: total_revenue
        description: Total revenue generated by this category in the month.
        data_tests:
          - not_null
          - greater_than_or_equal_to:
              arguments:
                value: 0

      - name: average_unit_price
        description: Average unit price across all products in this category for the month.